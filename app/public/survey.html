<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Quiz</title>
    <!-- my local stylesheet -->
    <link rel="stylesheet" type="text/css" href="app/public/style.css">
    <!-- bootstrap -->
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <!-- jQuery library -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <!-- Latest compiled JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
	<div class="container">
		<h1>Take the Quiz</h1>
		<hr>
		<form role="form" id="quiz">
			<h2>Tell us about yourself first</h2>
			<div class="form-group">
				<label for="usr">Name: (Required)</label>
				<input type="text" class="form-control" id="name">
			</div>
			<div class="form-group">
				<label for="pic">Link your Photo: (URL Required)</label>
				<input type="text" class="form-control" id="pic">
			</div>
			<hr>
			<h2>Provide responses to the following statements:</h2>
			<div class="row col-xs-12 col-md-12 col-lg-12">
				<h3>Question 1</h3>
				<h4>I enjoy long walks in the park/White House Gardens</h4>
				<div class="form-group col-xs-3">
					<select class="form-control" id="quest1">
						<option>1 (Fox and Friends is the only window I need to this world)</option>
						<option>2 (Only if there's a press conference)</option>
						<option>3 (At least no one can hear us out there)</option>
						<option>4 (I could go for a walk)</option>
						<option>5 (Let's hide from the press in the bushes)</option>
					</select>
				</div>
			</div>
			<div class="row col-xs-12 col-md-12 col-lg-12">
				<h3>Question 2</h3>
				<h4>What is your favorite way to take a break from a Senate lunch?</h4>
				<div class="form-group col-xs-3">
					<select class="form-control" id="quest2">
						<option>1 (Pretend to be on the phone behind a trash can)</option>
						<option>2 (Lock yourself in the Oval Office)</option>
						<option>3 (Just quit your job)</option>
						<option>4 (Talk to the press)</option>
						<option>5 (Get fired from your job)</option>
					</select>
				</div>
            </div>
            <div class="row col-xs-12 col-md-12 col-lg-12">
                <h3>Question 3</h3>
                <h4>How would you handle tough questions?</h4>
                <div class="form-group col-xs-3">
                    <select class="form-control" id="quest3">
                        <option>1 (Provide Alternative Facts)</option>
                        <option>2 (Completely change the topic)</option>
                        <option>3 (Just lie)</option>
                        <option>4 (Y'all got any more of them possums?)</option>
                        <option>5 (Don't lie, but get fired for it)</option>
                    </select>
                </div>
            </div>
            <div class="row col-xs-12 col-md-12 col-lg-12">
                <h3>Question 4</h3>
                <h4>What is your favorite White House lunch?</h4>
                <div class="form-group col-xs-3">
                    <select class="form-control" id="quest4">
                        <option>1 (McDonald's)</option>
                        <option>2 (White House Mess)</option>
                        <option>3 (BBQ)</option>
                        <option>4 (Fish Sandwich)</option>
                        <option>5 (Shit Sandwich)</option>
                    </select>
                </div>
            </div>
            <div class="row col-xs-12 col-md-12 col-lg-12">
                <h3>Question 5</h3>
                <h4>I like my steak well done, blackened like a hockey puck and tough as leather, without a trace of pink.</h4>
                <div class="form-group col-xs-3">
                    <select class="form-control" id="quest5">
                        <option>1 (Strongly Disagree)</option>
                        <option>2 (Somewhat Disagree)</option>
                        <option>3 (Neutral)</option>
                        <option>4 (Somewhat Agree)</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
            </div>
            <div class="row col-xs-12 col-md-12 col-lg-12">
                <h3>Question 6</h3>
                <h4>I like to get up and working hard as early as possible!</h4>
                <div class="form-group col-xs-3">
                    <select class="form-control" id="quest6">
                        <option>1 (Strongly Disagree)</option>
                        <option>2 (Somewhat Disagree)</option>
                        <option>3 (Neutral)</option>
                        <option>4 (Somewhat Agree)</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
            </div>
            <div class="row col-xs-12 col-md-12 col-lg-12">
                <h3>Question 7</h3>
                <h4>My preferred daytime activity is:</h4>
                <div class="form-group col-xs-3">
                    <select class="form-control" id="quest7">
                        <option>1 (Golf)</option>
                        <option>2 (Hide and Seek)</option>
                        <option>3 (Creative Writing)</option>
                        <option>4 (Party party party!)</option>
                        <option>5 (Working Hard)</option>
                    </select>
                </div>
            </div>
            <div class="row col-xs-12 col-md-12 col-lg-12">
                <h3>Question 8</h3>
                <h4>Can the secret service come to dinner, too?</h4>
                <div class="form-group col-xs-3">
                    <select class="form-control" id="quest8">
                        <option>1 (Strongly Disagree)</option>
                        <option>2 (Somewhat Disagree)</option>
                        <option>3 (Neutral)</option>
                        <option>4 (Somewhat Agree)</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
            </div>
            <div class="row col-xs-12 col-md-12 col-lg-12">
                <h3>Question 9</h3>
                <h4>If you had to pick one, what would you watch before starting your day?</h4>
                <div class="form-group col-xs-3">
                    <select class="form-control" id="quest9">
                        <option>1 (Fox News)</option>
                        <option>2 (CNN)</option>
                        <option>3 (Cartoons)</option>
                        <option>4 (C-SPAN)</option>
                        <option>5 (COPS)</option>
                    </select>
                </div>
            </div>
            <div class="row col-xs-12 col-md-12 col-lg-12">
                <h3>Question 10</h3>
                <h4>How likely are you to take a quiz as dumb as this?</h4>
                <div class="form-group col-xs-3">
                    <select class="form-control" id="quest10">
                        <option>1 (Never)</option>
                        <option>2 (With some arm twisting)</option>
                        <option>3 (Sometimes)</option>
                        <option>4 (Why not?)</option>
                        <option>5 (All the time)</option>
                    </select>
                </div>
            </div>
			<button type="button" class="btn btn-success btn-block" id="submit">Choose my destiny</button>
		</form>
		<!-- Modal stuff-->
        <div class="modal fade" id="friend-modal" role="dialog">
        <div class="modal-dialog">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title"></h4>
        </div>
        <div class="modal-body">
        </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
    </div>
        <div class="footer">
            <p>Joe Finnegan</p>
            <p>Code Bootcamp 2018</p>
        </div>
    </div>
        <script type="text/javascript">
            $('#submit').on("click", function(){
                //check to make sure the form is filled out
                var validEntry;
                if($("#name").val().trim() === ''){
                    alert('Please enter a name');
                }
                else if($("#pic").val().trim() === ''){
                    alert('Please enter a link to photo');
                }
                else{
                    //empty array to hold the value from the quiz questions
                    var answerArray = [];
                    //loop to push the answers from quiz to the array (NEED TO UPDATE i< AS QUESTIONS ARE ADDED)
                    for(i=1; i<11; i++){
                        console.log('#quest' + i)
                        answerArray.push(parseInt($('#quest' + i).val().substring(0,1)));
                    }
                    //creating an object to hold the newly entered information
                    var newFriend = 
                    {
                        name: $("#name").val().trim(),
                        photo: $("#pic").val().trim(),
                        scores: answerArray
                    };
                    //records the current location (should work after deployment)
                    var currentURL = window.location.origin;
                    //add the newly entered information to the friend array
                    $.post(currentURL + "/api/friends", newFriend,
                    function(data){});
                    //access our array of potential friends so we can analyze it for the best match
                    $.ajax({url: currentURL + "/api/friends", method: "GET"}).done(function(res){
                            
                        var futureLove;
                        var currentBest = 100;
                        var differenceArray = [];
                        //loops through all friends with the exception of the one just created
                        for(i=0; i < res.length - 1; i++){
                            //compares the values from the quiz questions and pushes the absolute value of the differences to the difference array
                            for(j=0; j<10; j++){
                                var currentDifference = newFriend.scores[j] - res[i].scores[j];
                                differenceArray.push(Math.abs(currentDifference));
                            }
                            //adds the values in the array to give a single value that represents the difference between a potential friend and the current entry
                            var difference = differenceArray.reduce(add, 0);
                            //if the difference is less than any of the previous comparisons, push the current profile to the best match position
                            if(difference < currentBest){
                                futureLove = res[i];
                                currentBest = difference;
                                differenceArray = [];
                            }
                            //or just move on
                            else{
                                differenceArray =[];
                            }
                            
                        }
                        // set up the display for the modal
                        var loveName = '<h4>' + futureLove.name + '<h4>';
                        var lovePic = '<img width="300px" src=' + futureLove.photo + '>';
                        // use jQuery to show the modal sections
                        $('#friend-modal').modal('show');
                        $('#friend-modal h4').html(loveName);
                        $('.modal-body').html(lovePic);
                        //lear the entries
                        $('#quiz')[0].reset();
                    });
                }
                return false;
            });
    function add(a, b){
         return a+b;
        };
        </script>        
    </body>
</html>